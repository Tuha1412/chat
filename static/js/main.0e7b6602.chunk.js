(this["webpackJsonpapp-chat"]=this["webpackJsonpapp-chat"]||[]).push([[0],{174:function(e,t,n){},175:function(e,t,n){},256:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(26),r=n.n(i),o=(n(174),n(175),n(89)),s=n.n(o),l=n(105),d=n(266),u=n(261),j=n(262),b=n(71),p=n(91);n(257),n(176),n(258);p.a.initializeApp({apiKey:"AIzaSyCR2WGPzKfVJsrCNLzOdwYFPUyB-eVLNYQ",authDomain:"app-chat-66ff1.firebaseapp.com",projectId:"app-chat-66ff1",storageBucket:"app-chat-66ff1.appspot.com",messagingSenderId:"724611761415",appId:"1:724611761415:web:ec0452e2aebbccb98d71a2",measurementId:"G-20PED2KEEE"}),p.a.analytics();var h=p.a.auth(),m=p.a.firestore(),O=p.a,x=n(136),f=n(42),v=function(e,t){m.collection(e).add(Object(f.a)(Object(f.a)({},t),{},{createdAt:O.firestore.FieldValue.serverTimestamp()}))},g=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],i=[],r=0;r<n;r++)a[r]=!1;return function e(r){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[r]=t[o],r===n-1&&i.push(c.join(" ")),e(r+1),a[o]=!1)}(0),i.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(x.a)(e),Object(x.a)(n))}),[])},y=n(7),C=d.a.Title,N=new O.auth.FacebookAuthProvider;function I(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.signInWithPopup(N);case 2:t=e.sent,n=t.additionalUserInfo,a=t.user,(null===n||void 0===n?void 0:n.isNewUser)&&v("users",{displayName:a.displayName,email:a.email,uid:a.uid,photoURL:a.photoURL,providerId:n.providerId,keywords:g(a.displayName)});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(y.jsx)("div",{children:Object(y.jsx)(u.a,{justify:"center",style:{height:800},children:Object(y.jsxs)(j.a,{span:8,children:[Object(y.jsx)(C,{style:{textAlign:"center"},level:3,children:"Chat"}),Object(y.jsx)(b.a,{style:{width:"100%",marginBottom:5},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Google"}),Object(y.jsx)(b.a,{style:{width:"100%"},onClick:e,children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"})]})})})}var w=n(131),R=n(27),U=n(37),L=n(268),V=n(38),A=n(273),k=n(31),F=n(263),S=c.a.createContext();function T(e){var t=e.children,n=Object(a.useState)({}),c=Object(k.a)(n,2),i=c[0],r=c[1],o=Object(R.f)(),s=Object(a.useState)(!0),l=Object(k.a)(s,2),d=l[0],u=l[1];return Object(a.useEffect)((function(){var e=h.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;return r({displayName:t,email:n,uid:a,photoURL:c}),u(!1),void o.push("/")}u(!1),o.push("/login")}));return function(){e()}}),[o]),Object(y.jsx)(S.Provider,{value:{user:i},children:d?Object(y.jsx)(F.a,{}):t})}var M,P,z=function(e,t){var n=Object(a.useState)([]),i=Object(k.a)(n,2),r=i[0],o=i[1];return c.a.useEffect((function(){var n=m.collection(e);if(t){if(!t.compareValue||!t.compareValue.length)return void o([]);n=n.where(t.fieldName,t.operator,t.compareValue)}return n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(f.a)(Object(f.a)({},e.data()),{},{id:e.id})}));o(t)}))}),[e,t]),r},E=c.a.createContext();function B(e){var t=e.children,n=Object(a.useState)(!1),i=Object(k.a)(n,2),r=i[0],o=i[1],s=Object(a.useState)(!1),l=Object(k.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(""),b=Object(k.a)(j,2),p=b[0],h=b[1],m=Object(a.useContext)(S).user.uid,O=c.a.useMemo((function(){return{fieldName:"members",operator:"array-contains",compareValue:m}}),[m]),x=z("rooms",O);console.log(x);var f=Object(a.useMemo)((function(){return x.find((function(e){return e.id===p}))||{}}),[x,p]),v=c.a.useMemo((function(){return{fieldName:"uid",operator:"in",compareValue:f.members}}),[f.members]),g=z("users",v);return Object(y.jsx)(E.Provider,{value:{rooms:x,isAddRoomVisible:r,setIsAddRoomVisible:o,selectedRoomId:p,setSelectedRoomId:h,selectedRoom:f,members:g,isInviteMemberVisible:d,setIsInviteMemberVisible:u,clearState:function(){h(""),o(!1),u(!1)}},children:t})}var D=L.a.Panel,G=Object(V.a)(D)(M||(M=Object(U.a)(["\n    &&& {\n        .ant-collapse-header, p{\n            color: white\n        }\n        .ant-collapse-content-box{\n            padding: 0 40px;\n        }\n        .add-room{\n            color: white;\n            padding: 0;\n        }\n    }\n"]))),K=Object(V.a)(d.a.Link)(P||(P=Object(U.a)(["\n    display: block;\n    margin-bottom: 5px;\n    color: white;\n"])));function J(){var e=Object(a.useContext)(E),t=e.rooms,n=e.setIsAddRoomVisible,c=e.setSelectedRoomId;return Object(y.jsx)(L.a,{ghost:!0,defaultActiveKey:["1"],children:Object(y.jsxs)(G,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[t.map((function(e){return Object(y.jsx)(K,{onClick:function(){return c(e.id)},children:e.name},e.id)})),Object(y.jsx)(b.a,{type:"text",onClick:function(){n(!0)},icon:Object(y.jsx)(A.a,{}),className:"add-room",children:"Th\xeam ph\xf2ng"})]},"1")})}var W,Y,H=n(271),Q=V.a.div(W||(W=Object(U.a)(["\n    display: flex;\n    justify-content: space-between;\n    padding: 12px 16px;\n    border-bottom: 1px solid rgba(82, 38, 83);\n\n    .username {\n        color: white;\n        margin-left: 5px;\n    }\n"])));function q(){var e=Object(a.useContext)(S).user,t=e.displayName,n=e.photoURL;return Object(y.jsxs)(Q,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(H.a,{src:n,children:n?"":null===t||void 0===t?void 0:t.charAt(0).toUpperCase()}),Object(y.jsx)(d.a.Text,{className:"username",children:t})]}),Object(y.jsx)(b.a,{ghost:!0,onClick:function(){return h.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})}var X=V.a.div(Y||(Y=Object(U.a)(["\n    background: #3f0e40;\n    color: white;\n    height: 100vh;\n"])));function Z(){return Object(y.jsx)(X,{children:Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(q,{})}),Object(y.jsx)(j.a,{span:24,children:Object(y.jsx)(J,{})})]})})}var $,_,ee,te,ne,ae,ce,ie=n(274),re=n(265),oe=n(67),se=n(269),le=n(272),de=n(264),ue=V.a.div($||($=Object(U.a)(["\n    margin-bottom: 10px; \n    \n    .author{\n        margin-left: 5px;\n        font-weight: bold;\n    }\n    .date{\n        margin-left: 10px;\n        font-size: 11px;\n        color: #a7a7a7;\n    }\n    .content{\n        margin-left: 40px;\n    }\n"])));function je(e){var t="";return e&&(t=(t=Object(de.a)(new Date(1e3*e),new Date)).charAt(0).toLocaleUpperCase()+t.slice(1)),t}function be(e){var t,n=e.text,a=e.displayName,c=e.createdAt,i=e.photoURL;return Object(y.jsxs)(ue,{children:[Object(y.jsxs)("div",{children:[Object(y.jsx)(H.a,{size:"small",src:i,children:i?"":null===(t=a.charAt(0))||void 0===t?void 0:t.toLocaleUpperCase()}),Object(y.jsx)(d.a.Text,{className:"author",children:a}),Object(y.jsx)(d.a.Text,{className:"date",children:je(null===c||void 0===c?void 0:c.seconds)})]}),Object(y.jsx)("div",{children:Object(y.jsx)(d.a.Text,{className:"content",children:n})})]})}var pe=V.a.div(_||(_=Object(U.a)(["\n    height: 100vh;\n"]))),he=V.a.div(ee||(ee=Object(U.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    height: 60px;\n    padding: 0 16px;\n\n    border-bottom: 1px solid rgb(230, 230, 230);\n    \n    .header{\n        &-info{\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n        }\n        &-title{\n            margin: 0;\n            font-weight: bold;\n        }\n        &-description{\n            font-size: 13px;\n        }\n    }\n"]))),me=V.a.div(te||(te=Object(U.a)(["\n    display: flex;\n    align-items: center;\n\n    .btn-add{\n        margin: 10px;\n    }\n"]))),Oe=V.a.div(ne||(ne=Object(U.a)(["\n    max-height: 100%;\n    overflow-y: auto;\n"]))),xe=V.a.div(ae||(ae=Object(U.a)(["\n    height: calc(100% - 60px);\n    display: flex;\n    flex-direction: column;\n    padding: 11px;\n    justify-content: flex-end;  \n"]))),fe=Object(V.a)(re.a)(ce||(ce=Object(U.a)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 2px 2px 2px 0;\n    border: 1px solid rgba(230, 230, 230);\n    border-radius: 2px;\n\n    .ant-form-item{\n        flex: 1;\n        margin-bottom: 0;\n    }\n"])));function ve(){var e=Object(a.useContext)(E),t=e.selectedRoom,n=e.members,i=e.setIsInviteMemberVisible,r=Object(a.useContext)(S).user,o=r.uid,s=r.photoURL,l=r.displayName,d=Object(a.useState)(""),u=Object(k.a)(d,2),j=u[0],p=u[1],h=re.a.useForm(),m=Object(k.a)(h,1)[0],O=function(){v("messages",{text:j,uid:o,photoURL:s,roomId:t.id,displayName:l}),m.resetFields(["message"])},x=c.a.useMemo((function(){return{fieldName:"roomId",operator:"==",compareValue:t.id}}),[t.id]),f=z("messages",x);return Object(y.jsx)(pe,{children:t.id?Object(y.jsxs)(y.Fragment,{children:[Object(y.jsxs)(he,{children:[Object(y.jsxs)("div",{className:"header-info",children:[Object(y.jsx)("p",{className:"header-title",children:t.name}),Object(y.jsx)("span",{className:"header-description",children:t.description})]}),Object(y.jsxs)(me,{children:[Object(y.jsx)(b.a,{onClick:function(){return i(!0)},className:"btn-add",type:"text",icon:Object(y.jsx)(ie.a,{}),children:"M\u1eddi"}),Object(y.jsx)(H.a.Group,{size:"small",maxCount:2,children:n.map((function(e){var t;return Object(y.jsx)(oe.a,{title:e.displayName,children:Object(y.jsx)(H.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t?void 0:t.charAt(0).toUpperCase()})},e.id)}))})]})]}),Object(y.jsxs)(xe,{children:[Object(y.jsx)(Oe,{children:f.map((function(e){return Object(y.jsx)(be,{text:e.text,displayName:e.displayName,photoURL:e.photoURL,createdAt:e.createdAt},e.id)}))}),Object(y.jsxs)(fe,{form:m,children:[Object(y.jsx)(re.a.Item,{name:"message",children:Object(y.jsx)(se.a,{placeholder:"Nh\u1eadp tin nh\u1eafn",bordered:!1,autoComplete:"off",onChange:function(e){p(e.target.value)},onPressEnter:O})}),Object(y.jsx)(b.a,{type:"primary",onClick:O,children:"G\u1eedi"})]})]})]}):Object(y.jsx)(le.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:5},closable:!0})})}function ge(){return Object(y.jsxs)(u.a,{children:[Object(y.jsx)(j.a,{span:6,children:Object(y.jsx)(Z,{})}),Object(y.jsx)(j.a,{span:18,children:Object(y.jsx)(ve,{})})]})}var ye=n(270);function Ce(){var e=Object(a.useContext)(E),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,c=Object(a.useContext)(S).user.uid,i=re.a.useForm(),r=Object(k.a)(i,1)[0];return Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"T\u1ea1o ph\xf2ng",visible:t,onOk:function(){v("rooms",Object(f.a)(Object(f.a)({},r.getFieldValue()),{},{members:[c]})),r.resetFields(),n(!1)},onCancel:function(){r.resetFields(),n(!1)},children:Object(y.jsxs)(re.a,{form:r,layout:"vertical",children:[Object(y.jsx)(re.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(y.jsx)(se.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(y.jsx)(re.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(y.jsx)(se.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})}var Ne=n(167),Ie=n(267),we=n(158),Re=["fetchOptions","debounceTimeout"];function Ue(e){var t=e.fetchOptions,n=e.debounceTimeout,c=void 0===n?300:n,i=Object(Ne.a)(e,Re),r=Object(a.useState)(!1),o=Object(k.a)(r,2),s=o[0],l=o[1],d=Object(a.useState)([]),u=Object(k.a)(d,2),j=u[0],b=u[1],p=Object(a.useMemo)((function(){return Object(we.debounce)((function(e){b([]),l(!0),t(e).then((function(e){b(e),l(!1)}))}),c)}),[c,t]);return Object(y.jsx)(Ie.a,Object(f.a)(Object(f.a)({labelInValue:!0,filterOption:!1,onSearch:p,notFoundContent:s?Object(y.jsx)(F.a,{size:"small"}):null},i),{},{children:j.map((function(e){var t;Ie.a.Option,e.value,e.label,H.a,e.photoURL,e.photoURL||null===(t=e.label)||void 0===t||t.charAt(0).toUpperCase(),"".concat(e.label),e.value}))}))}function Le(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m.collection("users").where("keywords","array-contains",t).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{label:e.data().displayName,value:e.data().uid,photoURL:e.data().photoURL}}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){var e=Object(a.useContext)(E),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,c=Object(a.useContext)(S).user.uid,i=Object(a.useState)([]),r=Object(k.a)(i,2),o=r[0],s=r[1],l=re.a.useForm(),d=Object(k.a)(l,1)[0];return Object(y.jsx)("div",{children:Object(y.jsx)(ye.a,{title:"Th\xeam th\xe0nh vi\xean",visible:t,onOk:function(){v("rooms",Object(f.a)(Object(f.a)({},d.getFieldValue()),{},{members:[c]})),d.resetFields(),n(!1)},onCancel:function(){d.resetFields(),n(!1)},children:Object(y.jsx)(re.a,{form:d,layout:"vertical",children:Object(y.jsx)(Ue,{mode:"multiple",label:"T\xean c\xe1c th\xe0nh vi\xean",value:o,placeholder:"Nh\u1eadp t\xean th\xe0nh vi\xean",fetchOptions:Le,onChange:function(e){return s(e)},style:{width:"100%"}})})})})}var ke=function(){return Object(y.jsx)(w.a,{children:Object(y.jsx)(T,{children:Object(y.jsxs)(B,{children:[Object(y.jsxs)(R.c,{children:[Object(y.jsx)(R.a,{component:I,path:"/login"}),Object(y.jsx)(R.a,{component:ge,path:"/"})]}),Object(y.jsx)(Ce,{}),Object(y.jsx)(Ae,{})]})})})},Fe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,275)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),i(e),r(e)}))};r.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(ke,{})}),document.getElementById("root")),Fe()}},[[256,1,2]]]);
//# sourceMappingURL=main.0e7b6602.chunk.js.map